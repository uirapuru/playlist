<html>
<head>
    <title>{% if song is not null %}{{ song.title }} ({{ playlist.name }}){% else %}playlist{% endif %}</title>

    <script>
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/player_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;

        function onYouTubePlayerAPIReady() {
            player = new YT.Player('ytplayer', {
                height: '390',
                width: '640',
                playerVars: { 'autoplay': 1, 'controls': 1,'autohide':1,'wmode':'opaque' },
                videoId: '{% if song is not null %}{{ song.videoId }}{% endif %}',
                events: {
                    'onStateChange': function (state) {
                        {% if nextVideoId is not null %}
                        if(state.data == 0) {
                            window.location.href = '{{ path("song", {playlist: playlist.id, song: nextVideoId}) }}';
                        }
                        {% endif %}
                    }
                }
            });
        }
    </script>

</head>
<body>
    <table>
        <tbody>
        <tr>
            <td rowspan="3">
                <div id="ytplayer"></div>
            </td>
            <td>
                {{ form(playlistForm) }}
            </td>
            </tr>
        <tr>
            <td>

                <ul style="list-style: none">Songs:
                    {% for lisong in songs %}
                        <li>
                            {% if lisong == song %}
                                <strong>&blacktriangleright;</strong>
                            {% endif %}
                            <a href="{{ path("song", {song: lisong.id, playlist: playlist.id}) }}">{{ lisong.title }}</a>
                        </li>
                    {% else %}
                        <li>No songs</li>
                    {% endfor %}
                </ul>
            </td>
        </tr>
        <tr>
            <td>
                <a href="{{ path('admin_app_song_create') }}">dodaj piosenkę</a> |
                <a href="{{ path("song", {playlist: playlist.id, song: nextVideoId}) }}">następna piosenka</a>
            </td>
        </tr>
        </tbody>
    </table>


</body>
</html>

